package com.rockdot.plugin.facebook.command {	import com.facebook.graph.data.FacebookSession;	import com.greensock.TweenLite;	import com.rockdot.core.model.RockdotConstants;	import com.rockdot.core.mvc.RockdotEvent;	import com.rockdot.plugin.facebook.airhack.FacebookAIR;	import com.rockdot.plugin.facebook.command.event.FBEvents;	import flash.events.IOErrorEvent;	public class FBInitStageWebViewCommand extends AbstractFBCommand{		override public function execute(event : RockdotEvent = null) : * {			super.execute(event);			if (RockdotConstants.LOCAL) {				log.debug("Facebook Not Supported here.");				TweenLite.delayedCall(.01, dispatchCompleteEvent);			} else {				FacebookAIR.init(getProperty("project.facebook.appid"), _handleComplete, null, RockdotConstants.getStage());			}		}		private function _handleComplete(response : Object, fail : Object = null) : void {			if (response != null && response.accessToken != null) {				_fbModel.userIsAuthenticated = true;				_fbModel.session = response as FacebookSession;								new RockdotEvent(FBEvents.USER_GETINFO_PERMISSIONS, null, _onPermissions).dispatch();							}			if(fail){				if(fail is IOErrorEvent){					log.debug((fail as IOErrorEvent).text);					dispatchCompleteEvent(fail.text);				}				else{					log.debug("FB Init did not produce a valid access token: {1} (code: {2}, type: {3})", [fail.error.message, fail.error.code, fail.error.type]);					dispatchCompleteEvent(fail.error.message);				}			}		}		private function _onPermissions(perms : Array) : void {			dispatchCompleteEvent(_fbModel.session);		}			}}